!function(){"use strict";class e{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._inputInvalidClass=e.inputInvalidClass,this._formElement=t,this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputs=Array.from(this._formElement.querySelectorAll(this._inputSelector))}_hideAllErrors(){Array.from(this._formElement.querySelectorAll(`.${this._inputErrorClass}`)).forEach((e=>{this._hideInputError(e)}))}_validateInput(e){const t=e.parentElement.querySelector(`.${this._inputErrorClass}`);e.validity.valid?this._hideInputError(t,e):this._showInputError(t,e.validationMessage,e)}_showInputError(e,t,r){e.textContent=t,e.classList.add(this._errorClass),r&&r.classList.add(this._inputInvalidClass)}_hideInputError(e,t){e.textContent="",e.classList.remove(this._errorClass),t&&t.classList.remove(this._inputInvalidClass)}_toggleButtonState(){this._inputs.every((e=>e.validity.valid))?this._enableButton():this._disableButton()}_enableButton(){this._submitButton.removeAttribute("disabled"),this._submitButton.classList.remove(this._inactiveButtonClass)}_disableButton(){this._submitButton.setAttribute("disabled",!0),this._submitButton.classList.add(this._inactiveButtonClass)}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._inputs.forEach((e=>{e.addEventListener("input",(()=>{this._validateInput(e),this._toggleButtonState()}))}))}disableButton(){this._submitButton&&this._disableButton()}}class t{constructor(e,t,r,s,n){this._id=e._id,this._name=e.name,this._link=e.link,this._isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=r,this._handleDeleteButtonClick=s,this._handleLikeButtonClick=n}_getTemplate(){const e=document.querySelector(this._cardSelector);this._cardElement=e.content.firstElementChild.cloneNode(!0)}_setEventListeners(){this._cardLikeButton.addEventListener("click",(()=>{this._handleLikeButtonClick(this)})),this._cardDeleteButton.addEventListener("click",(()=>{this._handleDeleteButtonClick(this)})),this.cardImageElement.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}cardIsLiked(){return this._isLiked}handleDeleteButton=()=>{this._cardElement.remove(),this._cardElement=null};handleLikeButton=()=>{this._cardLikeButton.classList.toggle("liked")};getView(){return this._getTemplate(),this._cardLikeButton=this._cardElement.querySelector(".card__like-button"),this._cardDeleteButton=this._cardElement.querySelector(".card__delete-button"),this.cardTitleElement=this._cardElement.querySelector(".card__title"),this.cardImageElement=this._cardElement.querySelector(".card__image"),this.cardTitleElement.textContent=this._name,this.cardImageElement.src=this._link,this.cardImageElement.alt=this._name,this._setEventListeners(),this._cardElement}}class r{constructor(e,t){let{items:r,renderer:s}=e;this._items=r,this._renderer=s,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{const t=this._renderer(e);this._container.append(t)}))}addItem(e){this._container.prepend(e)}}class s{constructor(e){this._popup=document.querySelector(e),this._closeButton=this._popup.querySelector(".modal__close")}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._closeButton.addEventListener("click",(()=>{this.close()})),this._popup.addEventListener("click",(e=>{e.target===this._popup&&this.close()}))}_handleEscClose=e=>{"Escape"===e.key&&this.close()}}class n extends s{constructor(e,t){super(e),this._submitCallback=t,this._form=this._popup.querySelector(".modal__form"),this._inputFields=Array.from(this._form.querySelectorAll(".modal__text-input")),this._submitButton=this._form.querySelector(".modal__button")}_getInputValues(){const e={};return this._inputFields.forEach((t=>{e[t.name]=t.value})),e}reset(){this._form.reset()}renderLoading(e){this._submitButton.textContent=e?"Saving...":"Save"}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._submitCallback(this._getInputValues()),this.reset()}))}}const i={formSelector:".modal__form",inputSelector:".modal__text-input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button-inactive",inputErrorClass:"modal__invalid",errorClass:"modal__invalid_active",inputInvalidClass:"modal__text_invalid"},o=document.querySelector(".profile__edit-button"),a=document.querySelector(".profile__add-button"),l=document.querySelector("#title-textbox"),c=document.querySelector("#subtitle-textbox"),d=document.querySelector("#card-title-textbox"),h=document.querySelector("#card-subtitle-textbox"),u=document.querySelector(".profile__add-image");function _(e){q.cardLike(e._id,e.cardIsLiked()).then((t=>{console.log("Card liked successfully"),e.handleLikeButton(t)})).catch((e=>{console.error("Error liking card:",e)}))}function m(e){p.setConfirm((()=>{p.renderLoading(!0),q.deleteCard(e._id).then((t=>{e.handleDeleteButton(t),p.close()})).catch((e=>{console.error("Error deleting card:",e),p.close()})).finally((()=>{p.renderLoading(!1)}))})),p.open()}const p=new class extends s{constructor(e){super(e),this._popupForm=this._popup.querySelector(".modal__form"),this._submitButton=this._popupForm.querySelector(".modal__button")}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()})),super.setEventListeners()}setConfirm(e){this._handleFormSubmit=e}renderLoading(e){this._submitButton.textContent=e?"Deleting...":"delete"}}("#delete-modal-popup",m);p.setEventListeners(),u.addEventListener("click",E);const v=new n("#modal-avatar-popup",(function(e){v.renderLoading(!0),q.updateAvatar(e).then((e=>{console.log("Avatar updated successfully"),g.setAvatar(e.avatar),v.close()})).catch((e=>{console.error("Error updating avatar:",e)})).finally((()=>{v.renderLoading(!1)}))}));function E(){v.open()}v.setEventListeners();const f=new n("#profile-add-modal",(function(){f.renderLoading(!0),q.addCard({name:d.value,link:h.value}).then((e=>{console.log("Card added successfully:"),function(e){const t=new r({items:e,renderer:B},".cards__list"),s=B(e);t.addItem(s)}(e),f.close()})).catch((e=>{console.error("Error adding card:",e)})).finally((()=>{f.renderLoading(!1)}))})),b=new n("#profile-edit-modal",(function(){const e=l.value,t=c.value;b.renderLoading(!0),q.updateProfile().then((r=>{console.log("Profile updated successfully:",r),g.setUserInfo({name:e,job:t})})).catch((e=>{console.error("Error updating profile:",e)})).finally((()=>{b.renderLoading(!1),b.close()}))}));f.setEventListeners(),b.setEventListeners(),a.addEventListener("click",(()=>{f.open()})),o.addEventListener("click",(()=>{const{name:e,job:t}=g.getUserInfo();l.value=e,c.value=t,b.open()}));const g=new class{constructor(e){let{nameSelector:t,jobSelector:r,avatarSelector:s}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(r),this._avatarElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e){let{name:t,job:r}=e;this._nameElement.textContent=t,this._jobElement.textContent=r}setAvatar(e){this._avatarElement.src=e}}({nameSelector:".profile__title",jobSelector:".profile__subtitle",avatarSelector:".profile__image"}),S=document.forms["add-form"],L=document.forms["modal-form"],k=new e(i,S),C=new e(i,L);function y(e){I.open(e)}function B(e){return new t(e,"#card-template",y,m,_,E).getView()}k.disableButton(),C.disableButton(),k.enableValidation(),C.enableValidation();const I=new class extends s{constructor(e){super(e),this._image=this._popup.querySelector(".modal__image"),this._caption=this._popup.querySelector(".modal__image-subtitle")}open(e){this._image.src=e.link,this._image.alt=`Photo of ${e.name}`,this._caption.textContent=e.name,super.open()}setEventListeners(){super.setEventListeners()}}("#modal-image-preview");I.setEventListeners();const q=new class{constructor(e){this.baseUrl=e.baseUrl,this.headers=e.headers}_checkServerResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this.baseUrl}/cards`,{headers:this.headers}).then(this._checkServerResponse).catch((e=>{console.error("Error fetching initial cards:",e)}))}getUserInfo(){return fetch(`${this.baseUrl}/users/me`,{headers:this.headers}).then(this._checkServerResponse).catch((e=>{console.error("Error fetching user info:",e)}))}updateProfile(e,t){return fetch(`${this.baseUrl}/users/me`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then(this._checkServerResponse).catch((e=>{console.error("Error updating profile:",e)}))}addCard(e){let{name:t,link:r}=e;return fetch(`${this.baseUrl}/cards`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:r})}).then(this._checkServerResponse).catch((e=>{console.error("Error adding card:",e)}))}deleteCard(e){return fetch(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.headers}).then(this._checkServerResponse).catch((e=>{console.error("Error deleting card:",e)}))}cardLike(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then(this._checkServerResponse).catch((e=>{console.error(`Error ${t?"removing":"liking"} card:`,e)}))}updateAvatar(e){let{link:t}=e;return fetch(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:t})}).then(this._checkServerResponse).catch((e=>{console.error("Error updating avatar:",e)}))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"d9d73c7f-57bf-4e5e-8837-ef7b15edaabc","Content-Type":"application/json"}});q.getInitialCards().then((e=>{new r({items:e,renderer:B},".cards__list").renderItems()})).catch((e=>{console.error("Error fetching initial cards:",e)})),q.getUserInfo().then((e=>{g.setUserInfo({name:e.name,job:e.job}),g.setAvatar(e.avatar)})).catch((e=>{console.error("Error fetching initial cards:",e)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEtBQU1DLEtBQUtDLFVBQVUsQ0FBRTdDLE9BQVEvRixNQUU5QjRFLEtBQUt2SSxLQUFLMkwsc0JBQ1ZoRCxPQUFPQyxJQUNOSCxRQUFRRyxNQUFNLHlCQUEwQkEsRUFBTSxHQUVwRCxHSnFIa0IsQ0FDbEI2QyxRQUFTLGtEQUNUQyxRQUFTLENBQ1BpQixjQUFlLHVDQUNmLGVBQWdCLHNCQUlwQnRFLEVBQ0c0RCxrQkFDQTFELE1BQU1xRSxJQUNlLElBQUl2SCxFQUN0QixDQUNFRyxNQUFPb0gsRUFDUG5ILFNBQVVzRSxHQUVaLGdCQUdVbEUsYUFBYSxJQUUxQjhDLE9BQU9DLElBQ05ILFFBQVFHLE1BQU0sZ0NBQWlDQSxFQUFNLElBR3pEUCxFQUNHbUMsY0FDQWpDLE1BQU1DLElBQ0xnQixFQUFTYyxZQUFZLENBQ25CN0csS0FBTStFLEVBQUkvRSxLQUNWOEcsSUFBSy9CLEVBQUkrQixNQUVYZixFQUFTQyxVQUFVakIsRUFBSWtCLE9BQU8sSUFFL0JmLE9BQU9DLElBQ05ILFFBQVFHLE1BQU0sZ0NBQWlDQSxFQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9VdGlscy9Db25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBEZWxldGVDb25maXJtLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IHNldHRpbmdzLmZvcm1TZWxlY3RvcjtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEludmFsaWRDbGFzcyA9IHNldHRpbmdzLmlucHV0SW52YWxpZENsYXNzO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuXHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuICAgIHRoaXMuX2lucHV0cyA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUFsbEVycm9ycygpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudHMgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGAuJHt0aGlzLl9pbnB1dEVycm9yQ2xhc3N9YClcclxuICAgICk7XHJcbiAgICBlcnJvckVsZW1lbnRzLmZvckVhY2goKGVycm9yRWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihlcnJvckVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfdmFsaWRhdGVJbnB1dChpbnB1dCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gaW5wdXQucGFyZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7dGhpcy5faW5wdXRFcnJvckNsYXNzfWBcclxuICAgICk7XHJcbiAgICBpZiAoIWlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGVycm9yRWxlbWVudCwgaW5wdXQudmFsaWRhdGlvbk1lc3NhZ2UsIGlucHV0KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGVycm9yRWxlbWVudCwgaW5wdXQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGVycm9yRWxlbWVudCwgbWVzc2FnZSwgaW5wdXQpIHtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIGlmIChpbnB1dCkge1xyXG4gICAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0SW52YWxpZENsYXNzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihlcnJvckVsZW1lbnQsIGlucHV0KSB7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICBpZiAoaW5wdXQpIHtcclxuICAgICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEludmFsaWRDbGFzcyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBjb25zdCBpc1ZhbGlkID0gdGhpcy5faW5wdXRzLmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsaWRpdHkudmFsaWQpO1xyXG4gICAgaWYgKGlzVmFsaWQpIHtcclxuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCB0cnVlKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3ZhbGlkYXRlSW5wdXQoaW5wdXQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgaWYgKHRoaXMuX3N1Ym1pdEJ1dHRvbikge1xyXG4gICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVCdXR0b25DbGljayxcclxuICAgIGhhbmRsZUxpa2VCdXR0b25DbGlja1xyXG4gICkge1xyXG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGRhdGEuaXNMaWtlZDtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2sgPSBoYW5kbGVEZWxldGVCdXR0b25DbGljaztcclxuICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b25DbGljayA9IGhhbmRsZUxpa2VCdXR0b25DbGljaztcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IHRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0ZW1wbGF0ZS5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkLmNsb25lTm9kZSh0cnVlKTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b25DbGljayh0aGlzKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmREZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2sodGhpcyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLmNhcmRJbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7XHJcbiAgICAgICAgbmFtZTogdGhpcy5fbmFtZSxcclxuICAgICAgICBsaW5rOiB0aGlzLl9saW5rLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2FyZElzTGlrZWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faXNMaWtlZDtcclxuICB9XHJcblxyXG4gIGhhbmRsZURlbGV0ZUJ1dHRvbiA9ICgpID0+IHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH07XHJcblxyXG4gIGhhbmRsZUxpa2VCdXR0b24gPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwibGlrZWRcIik7XHJcbiAgfTtcclxuXHJcbiAgZ2V0VmlldygpIHtcclxuICAgIHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcblxyXG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b24gPVxyXG4gICAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fY2FyZERlbGV0ZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIlxyXG4gICAgKTtcclxuICAgIHRoaXMuY2FyZFRpdGxlRWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgICB0aGlzLmNhcmRJbWFnZUVsZW1lbnQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG5cclxuICAgIHRoaXMuY2FyZFRpdGxlRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLmNhcmRJbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuY2FyZEltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGNhcmRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xyXG4gICAgICBpZiAoZXZlbnQudGFyZ2V0ID09PSB0aGlzLl9wb3B1cCkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZlbnQpID0+IHtcclxuICAgIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIHN1Ym1pdENhbGxiYWNrKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3N1Ym1pdENhbGxiYWNrID0gc3VibWl0Q2FsbGJhY2s7XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2lucHV0RmllbGRzID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX190ZXh0LWlucHV0XCIpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCB2YWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0RmllbGRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIHZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgcmVzZXQoKSB7XHJcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgfVxyXG5cclxuICByZW5kZXJMb2FkaW5nKGxvYWRpbmcpIHtcclxuICAgIGlmIChsb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRDYWxsYmFjayh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgdGhpcy5yZXNldCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJGZXJyaXMgV2hlZWxcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE3MDA0MzMxNTg5NjgtYjFhYmYyNWJiOGY5P3E9ODAmdz0xODg3JmF1dG89Zm9ybWF0JmZpdD1jcm9wJml4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRFwiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJBaXIgQmFsbG9uXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNTU5OTI2MjIzLWU3MDAzNmExOGNlYj9xPTgwJnc9MTg4NyZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZpeGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0RcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiRmFsbHMgQ3JlZWtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE1NTE2NzU3MDUtNzI1MTNjMjcyMmEyP3E9ODAmdz0xOTc2JmF1dG89Zm9ybWF0JmZpdD1jcm9wJml4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRFwiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJPbGQgTWlsbFwiLFxyXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTYxODU3NzIwMTU4NS0zYWZhMmVjODgyYjE/cT04MCZ3PTE5NDQmYXV0bz1mb3JtYXQmZml0PWNyb3AmaXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkNheW9uXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNDkxNDY2NDI0OTM2LWUzMDQ5MTlhYWRhNz9xPTgwJnc9MjA2OSZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZpeGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0RcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiRnVzaW5lIExha2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wbHVzLnVuc3BsYXNoLmNvbS9wcmVtaXVtX3Bob3RvLTE2NjkyMzkxMTM1OTktZjUxYjc2NTg3ZGM5P3E9ODAmdz0xOTMzJmF1dG89Zm9ybWF0JmZpdD1jcm9wJml4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRFwiLFxyXG4gIH0sXHJcbl07XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9fdGV4dC1pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uLWluYWN0aXZlXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnZhbGlkXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9faW52YWxpZF9hY3RpdmVcIixcclxuICBpbnB1dEludmFsaWRDbGFzczogXCJtb2RhbF9fdGV4dF9pbnZhbGlkXCIsXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBlZGl0TW9kYWxUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0aXRsZS10ZXh0Ym94XCIpO1xyXG5leHBvcnQgY29uc3QgZWRpdE1vZGFsU3VidGl0bGVJbnB1dCA9XHJcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNzdWJ0aXRsZS10ZXh0Ym94XCIpO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZFRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGl0bGUtdGV4dGJveFwiKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRVcmxJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1zdWJ0aXRsZS10ZXh0Ym94XCIpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFySWNvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWltYWdlXCIpO1xyXG4iLCIvLyBJbXBvcnRlZCBtb2R1bGVzIGFuZCBjb21wb25lbnRzXHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuaW1wb3J0IFBvcHVwRGVsZXRlQ29uZmlybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cERlbGV0ZUNvbmZpcm0uanNcIjtcclxuaW1wb3J0IHtcclxuICBpbml0aWFsQ2FyZHMsXHJcbiAgY29uZmlnLFxyXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxyXG4gIHByb2ZpbGVBZGRCdXR0b24sXHJcbiAgZWRpdE1vZGFsVGl0bGVJbnB1dCxcclxuICBlZGl0TW9kYWxTdWJ0aXRsZUlucHV0LFxyXG4gIGFkZENhcmRUaXRsZUlucHV0LFxyXG4gIGFkZENhcmRVcmxJbnB1dCxcclxuICBhdmF0YXJJY29uLFxyXG59IGZyb20gXCIuLi9VdGlscy9Db25zdGFudHMuanNcIjtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUxpa2VCdXR0b25DbGljayhjYXJkKSB7XHJcbiAgYXBpXHJcbiAgICAuY2FyZExpa2UoY2FyZC5faWQsIGNhcmQuY2FyZElzTGlrZWQoKSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coXCJDYXJkIGxpa2VkIHN1Y2Nlc3NmdWxseVwiKTtcclxuICAgICAgY2FyZC5oYW5kbGVMaWtlQnV0dG9uKHJlcyk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgbGlraW5nIGNhcmQ6XCIsIGVycm9yKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVCdXR0b25DbGljayhjYXJkKSB7XHJcbiAgZGVsZXRlTW9kYWxQb3B1cC5zZXRDb25maXJtKCgpID0+IHtcclxuICAgIGRlbGV0ZU1vZGFsUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICAgIGFwaVxyXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLl9pZClcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGNhcmQuaGFuZGxlRGVsZXRlQnV0dG9uKHJlcyk7XHJcbiAgICAgICAgZGVsZXRlTW9kYWxQb3B1cC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGRlbGV0aW5nIGNhcmQ6XCIsIGVycm9yKTtcclxuICAgICAgICBkZWxldGVNb2RhbFBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICBkZWxldGVNb2RhbFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgICB9KTtcclxuICB9KTtcclxuICBkZWxldGVNb2RhbFBvcHVwLm9wZW4oKTtcclxufVxyXG5cclxuLy8gQ3JlYXRpbmcgYW4gaW5zdGFuY2Ugb2YgUG9wdXBXaXRoRm9ybSBmb3IgZGVsZXRlIG1vZGFsXHJcbmNvbnN0IGRlbGV0ZU1vZGFsUG9wdXAgPSBuZXcgUG9wdXBEZWxldGVDb25maXJtKFxyXG4gIFwiI2RlbGV0ZS1tb2RhbC1wb3B1cFwiLFxyXG4gIGhhbmRsZURlbGV0ZUJ1dHRvbkNsaWNrXHJcbik7XHJcblxyXG5kZWxldGVNb2RhbFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KGRhdGEpIHtcclxuICBhdmF0YXJNb2RhbFBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcblxyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZUF2YXRhcihkYXRhKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIkF2YXRhciB1cGRhdGVkIHN1Y2Nlc3NmdWxseVwiKTtcclxuICAgICAgdXNlckluZm8uc2V0QXZhdGFyKHJlcy5hdmF0YXIpO1xyXG4gICAgICBhdmF0YXJNb2RhbFBvcHVwLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgYXZhdGFyOlwiLCBlcnJvcik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBhdmF0YXJNb2RhbFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIEV2ZW50IGxpc3RlbmVyIGZvciBhdmF0YXIgaWNvbiBjbGljayB0byBvcGVuIGF2YXRhciBtb2RhbFxyXG5hdmF0YXJJY29uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVBdmF0YXJDbGljayk7XHJcblxyXG5jb25zdCBhdmF0YXJNb2RhbFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIjbW9kYWwtYXZhdGFyLXBvcHVwXCIsXHJcbiAgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdFxyXG4pO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyQ2xpY2soKSB7XHJcbiAgYXZhdGFyTW9kYWxQb3B1cC5vcGVuKCk7XHJcbn1cclxuXHJcbmF2YXRhck1vZGFsUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vRnVuY3Rpb24gdG8gaGFuZGxlIGNhcmQgZm9ybSBzdWJtaXNzaW9uXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRGb3JtU3VibWl0KCkge1xyXG4gIGFkZENhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG5cclxuICBhcGlcclxuICAgIC5hZGRDYXJkKHsgbmFtZTogYWRkQ2FyZFRpdGxlSW5wdXQudmFsdWUsIGxpbms6IGFkZENhcmRVcmxJbnB1dC52YWx1ZSB9KVxyXG4gICAgLnRoZW4oKGNhcmREYXRhKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiQ2FyZCBhZGRlZCBzdWNjZXNzZnVsbHk6XCIpO1xyXG4gICAgICByZW5kZXJDYXJkKGNhcmREYXRhKTtcclxuICAgICAgYWRkQ2FyZFBvcHVwLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgYWRkaW5nIGNhcmQ6XCIsIGVycm9yKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGFkZENhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyBDcmVhdGluZyBpbnN0YW5jZXMgb2YgcG9wdXAgZm9ybXNcclxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIjcHJvZmlsZS1hZGQtbW9kYWxcIixcclxuICBoYW5kbGVDYXJkRm9ybVN1Ym1pdFxyXG4pO1xyXG5jb25zdCBlZGl0TW9kYWxQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxyXG4gIGVkaXRQcm9maWxlTW9kYWxcclxuKTtcclxuXHJcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5lZGl0TW9kYWxQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gRXZlbnQgbGlzdGVuZXJzIGZvciBidXR0b25zXHJcbnByb2ZpbGVBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRDYXJkUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3QgeyBuYW1lLCBqb2IgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgZWRpdE1vZGFsVGl0bGVJbnB1dC52YWx1ZSA9IG5hbWU7XHJcbiAgZWRpdE1vZGFsU3VidGl0bGVJbnB1dC52YWx1ZSA9IGpvYjtcclxuICBlZGl0TW9kYWxQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuLy8gQ3JlYXRpbmcgVXNlckluZm8gaW5zdGFuY2VcclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fdGl0bGVcIixcclxuICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fc3VidGl0bGVcIixcclxuICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9faW1hZ2VcIixcclxufSk7XHJcblxyXG4vLyBGdW5jdGlvbiB0byBoYW5kbGUgZWRpdCBwcm9maWxlIGZvcm0gc3VibWlzc2lvblxyXG5mdW5jdGlvbiBlZGl0UHJvZmlsZU1vZGFsKCkge1xyXG4gIGNvbnN0IG5ld05hbWUgPSBlZGl0TW9kYWxUaXRsZUlucHV0LnZhbHVlO1xyXG4gIGNvbnN0IG5ld0pvYiA9IGVkaXRNb2RhbFN1YnRpdGxlSW5wdXQudmFsdWU7XHJcblxyXG4gIGVkaXRNb2RhbFBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcblxyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZVByb2ZpbGUoKVxyXG4gICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiUHJvZmlsZSB1cGRhdGVkIHN1Y2Nlc3NmdWxseTpcIiwgcmVzcG9uc2UpO1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7IG5hbWU6IG5ld05hbWUsIGpvYjogbmV3Sm9iIH0pO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHVwZGF0aW5nIHByb2ZpbGU6XCIsIGVycm9yKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGVkaXRNb2RhbFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgICBlZGl0TW9kYWxQb3B1cC5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbn1cclxuLy8gU2VsZWN0aW5nIHByb2ZpbGUgZm9ybSBlbGVtZW50c1xyXG5jb25zdCBwcm9maWxlQWRkZWRGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJhZGQtZm9ybVwiXTtcclxuY29uc3QgcHJvZmlsZUZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcIm1vZGFsLWZvcm1cIl07XHJcblxyXG4vLyBDcmVhdGluZyBmb3JtIHZhbGlkYXRvcnNcclxuY29uc3QgY2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHByb2ZpbGVBZGRlZEZvcm0pO1xyXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgcHJvZmlsZUZvcm0pO1xyXG5cclxuLy8gRGlzYWJsaW5nIGZvcm0gYnV0dG9uc1xyXG5jYXJkRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XHJcbnByb2ZpbGVGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcclxuXHJcbi8vIEVuYWJsaW5nIGZvcm0gdmFsaWRhdGlvblxyXG5jYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbnByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGhhbmRsZSBpbWFnZSBjbGlja1xyXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKGNhcmREYXRhKSB7XHJcbiAgaW1hZ2VQb3B1cC5vcGVuKGNhcmREYXRhKTtcclxufVxyXG5cclxuLy8gRnVuY3Rpb24gdG8gY3JlYXRlIGNhcmQgSFRNTFxyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGl0ZW0pIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IG5ldyBDYXJkKFxyXG4gICAgaXRlbSxcclxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVCdXR0b25DbGljayxcclxuICAgIGhhbmRsZUxpa2VCdXR0b25DbGljayxcclxuICAgIGhhbmRsZUF2YXRhckNsaWNrXHJcbiAgKTtcclxuXHJcbiAgcmV0dXJuIGNhcmRFbGVtZW50LmdldFZpZXcoKTtcclxufVxyXG5cclxuLy8gQ3JlYXRpbmcgaW5zdGFuY2Ugb2YgUG9wdXBXaXRoSW1hZ2VcclxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNtb2RhbC1pbWFnZS1wcmV2aWV3XCIpO1xyXG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vLyBGdW5jdGlvbiB0byByZW5kZXIgYSBzaW5nbGUgY2FyZFxyXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XHJcbiAgY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICAgIHtcclxuICAgICAgaXRlbXM6IGNhcmREYXRhLFxyXG4gICAgICByZW5kZXJlcjogY3JlYXRlQ2FyZCxcclxuICAgIH0sXHJcbiAgICBcIi5jYXJkc19fbGlzdFwiXHJcbiAgKTtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xyXG4gIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG59XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJkOWQ3M2M3Zi01N2JmLTRlNWUtODgzNy1lZjdiMTVlZGFhYmNcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuYXBpXHJcbiAgLmdldEluaXRpYWxDYXJkcygpXHJcbiAgLnRoZW4oKGNhcmRzKSA9PiB7XHJcbiAgICBjb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgaXRlbXM6IGNhcmRzLFxyXG4gICAgICAgIHJlbmRlcmVyOiBjcmVhdGVDYXJkLFxyXG4gICAgICB9LFxyXG4gICAgICBcIi5jYXJkc19fbGlzdFwiXHJcbiAgICApO1xyXG5cclxuICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgaW5pdGlhbCBjYXJkczpcIiwgZXJyb3IpO1xyXG4gIH0pO1xyXG5cclxuYXBpXHJcbiAgLmdldFVzZXJJbmZvKClcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgIG5hbWU6IHJlcy5uYW1lLFxyXG4gICAgICBqb2I6IHJlcy5qb2IsXHJcbiAgICB9KTtcclxuICAgIHVzZXJJbmZvLnNldEF2YXRhcihyZXMuYXZhdGFyKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBpbml0aWFsIGNhcmRzOlwiLCBlcnJvcik7XHJcbiAgfSk7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBDb25maXJtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCgpO1xyXG4gICAgfSk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgc2V0Q29uZmlybShoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcobG9hZGluZykge1xyXG4gICAgaWYgKGxvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJEZWxldGluZy4uLlwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJkZWxldGVcIjtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICBqb2I6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gIH1cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGpvYiB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gam9iO1xyXG4gIH1cclxuXHJcbiAgc2V0QXZhdGFyKGF2YXRhcikge1xyXG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMgPSBhdmF0YXI7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FwdGlvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlLXN1YnRpdGxlXCIpO1xyXG4gIH1cclxuXHJcbiAgb3BlbihkYXRhKSB7XHJcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBgUGhvdG8gb2YgJHtkYXRhLm5hbWV9YDtcclxuICAgIHRoaXMuX2NhcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xyXG4gICAgdGhpcy5iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xyXG4gICAgdGhpcy5oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrU2VydmVyUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpXHJcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgaW5pdGlhbCBjYXJkczpcIiwgZXJyb3IpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpXHJcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgdXNlciBpbmZvOlwiLCBlcnJvcik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlUHJvZmlsZShuYW1lLCBhYm91dCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgLi4udGhpcy5oZWFkZXJzLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICBhYm91dDogYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tTZXJ2ZXJSZXNwb25zZSlcclxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB1cGRhdGluZyBwcm9maWxlOlwiLCBlcnJvcik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIC4uLnRoaXMuaGVhZGVycyxcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgbGluazogbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1NlcnZlclJlc3BvbnNlKVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGFkZGluZyBjYXJkOlwiLCBlcnJvcik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtpZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tTZXJ2ZXJSZXNwb25zZSlcclxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBkZWxldGluZyBjYXJkOlwiLCBlcnJvcik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2FyZExpa2UoaWQsIGlzTGlrZWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBpc0xpa2VkID8gXCJERUxFVEVcIiA6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1NlcnZlclJlc3BvbnNlKVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgJHtpc0xpa2VkID8gXCJyZW1vdmluZ1wiIDogXCJsaWtpbmdcIn0gY2FyZDpgLCBlcnJvcik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlQXZhdGFyKHsgbGluayB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyOiBsaW5rIH0pLFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tTZXJ2ZXJSZXNwb25zZSlcclxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB1cGRhdGluZyBhdmF0YXI6XCIsIGVycm9yKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9mb3JtU2VsZWN0b3IiLCJmb3JtU2VsZWN0b3IiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfaW5wdXRJbnZhbGlkQ2xhc3MiLCJpbnB1dEludmFsaWRDbGFzcyIsIl9mb3JtRWxlbWVudCIsIl9zdWJtaXRCdXR0b24iLCJxdWVyeVNlbGVjdG9yIiwiX2lucHV0cyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfaGlkZUFsbEVycm9ycyIsImZvckVhY2giLCJlcnJvckVsZW1lbnQiLCJfaGlkZUlucHV0RXJyb3IiLCJfdmFsaWRhdGVJbnB1dCIsImlucHV0IiwicGFyZW50RWxlbWVudCIsInZhbGlkaXR5IiwidmFsaWQiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIm1lc3NhZ2UiLCJ0ZXh0Q29udGVudCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImV2ZXJ5IiwiX2VuYWJsZUJ1dHRvbiIsIl9kaXNhYmxlQnV0dG9uIiwicmVtb3ZlQXR0cmlidXRlIiwic2V0QXR0cmlidXRlIiwiZW5hYmxlVmFsaWRhdGlvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsImRpc2FibGVCdXR0b24iLCJDYXJkIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVCdXR0b25DbGljayIsImhhbmRsZUxpa2VCdXR0b25DbGljayIsIl9pZCIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9pc0xpa2VkIiwiaXNMaWtlZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVCdXR0b25DbGljayIsIl9oYW5kbGVMaWtlQnV0dG9uQ2xpY2siLCJfZ2V0VGVtcGxhdGUiLCJ0ZW1wbGF0ZSIsImRvY3VtZW50IiwiX2NhcmRFbGVtZW50IiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2NhcmRMaWtlQnV0dG9uIiwiX2NhcmREZWxldGVCdXR0b24iLCJjYXJkSW1hZ2VFbGVtZW50IiwiY2FyZElzTGlrZWQiLCJoYW5kbGVEZWxldGVCdXR0b24iLCJoYW5kbGVMaWtlQnV0dG9uIiwidG9nZ2xlIiwiZ2V0VmlldyIsImNhcmRUaXRsZUVsZW1lbnQiLCJzcmMiLCJhbHQiLCJTZWN0aW9uIiwiX3JlZiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJjYXJkRWxlbWVudCIsImFwcGVuZCIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsIl9jbG9zZUJ1dHRvbiIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsImV2ZW50IiwidGFyZ2V0Iiwia2V5IiwiUG9wdXBXaXRoRm9ybSIsInN1Ym1pdENhbGxiYWNrIiwic3VwZXIiLCJfc3VibWl0Q2FsbGJhY2siLCJfZm9ybSIsIl9pbnB1dEZpZWxkcyIsIl9nZXRJbnB1dFZhbHVlcyIsInZhbHVlcyIsInZhbHVlIiwicmVzZXQiLCJyZW5kZXJMb2FkaW5nIiwibG9hZGluZyIsImNvbmZpZyIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUFkZEJ1dHRvbiIsImVkaXRNb2RhbFRpdGxlSW5wdXQiLCJlZGl0TW9kYWxTdWJ0aXRsZUlucHV0IiwiYWRkQ2FyZFRpdGxlSW5wdXQiLCJhZGRDYXJkVXJsSW5wdXQiLCJhdmF0YXJJY29uIiwiY2FyZCIsImFwaSIsImNhcmRMaWtlIiwidGhlbiIsInJlcyIsImNvbnNvbGUiLCJsb2ciLCJjYXRjaCIsImVycm9yIiwiZGVsZXRlTW9kYWxQb3B1cCIsInNldENvbmZpcm0iLCJkZWxldGVDYXJkIiwiZmluYWxseSIsIl9wb3B1cEZvcm0iLCJlIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJoYW5kbGVGb3JtU3VibWl0IiwiaGFuZGxlQXZhdGFyQ2xpY2siLCJhdmF0YXJNb2RhbFBvcHVwIiwidXBkYXRlQXZhdGFyIiwidXNlckluZm8iLCJzZXRBdmF0YXIiLCJhdmF0YXIiLCJhZGRDYXJkUG9wdXAiLCJhZGRDYXJkIiwiY2FyZERhdGEiLCJjYXJkU2VjdGlvbiIsImNyZWF0ZUNhcmQiLCJyZW5kZXJDYXJkIiwiZWRpdE1vZGFsUG9wdXAiLCJuZXdOYW1lIiwibmV3Sm9iIiwidXBkYXRlUHJvZmlsZSIsInJlc3BvbnNlIiwic2V0VXNlckluZm8iLCJqb2IiLCJnZXRVc2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZUVsZW1lbnQiLCJfam9iRWxlbWVudCIsIl9hdmF0YXJFbGVtZW50IiwiX3JlZjIiLCJwcm9maWxlQWRkZWRGb3JtIiwiZm9ybXMiLCJwcm9maWxlRm9ybSIsImNhcmRGb3JtVmFsaWRhdG9yIiwicHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJpbWFnZVBvcHVwIiwiX2ltYWdlIiwiX2NhcHRpb24iLCJvcHRpb25zIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfY2hlY2tTZXJ2ZXJSZXNwb25zZSIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJpZCIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwiY2FyZHMiXSwic291cmNlUm9vdCI6IiJ9