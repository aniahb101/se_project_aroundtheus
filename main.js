!function(){"use strict";class e{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._inputInvalidClass=e.inputInvalidClass,this._formElement=t,this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputs=Array.from(this._formElement.querySelectorAll(this._inputSelector))}_hideAllErrors(){Array.from(this._formElement.querySelectorAll(`.${this._inputErrorClass}`)).forEach((e=>{this._hideInputError(e)}))}_validateInput(e){const t=e.parentElement.querySelector(`.${this._inputErrorClass}`);e.validity.valid?this._hideInputError(t,e):this._showInputError(t,e.validationMessage,e)}_showInputError(e,t,s){e.textContent=t,e.classList.add(this._errorClass),s&&s.classList.add(this._inputInvalidClass)}_hideInputError(e,t){e.textContent="",e.classList.remove(this._errorClass),t&&t.classList.remove(this._inputInvalidClass)}_toggleButtonState(){this._inputs.every((e=>e.validity.valid))?this._enableButton():this._disableButton()}_enableButton(){this._submitButton.removeAttribute("disabled"),this._submitButton.classList.remove(this._inactiveButtonClass)}_disableButton(){this._submitButton.setAttribute("disabled",!0),this._submitButton.classList.add(this._inactiveButtonClass)}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._inputs.forEach((e=>{e.addEventListener("input",(()=>{this._validateInput(e),this._toggleButtonState()}))}))}disableButton(){this._submitButton&&this._disableButton()}}class t{constructor(e,t,s,r,i){this._id=e._id,this._name=e.name,this._link=e.link,this._isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteButtonClick=r,this._handleLikeButtonClick=i}_getTemplate(){const e=document.querySelector(this._cardSelector);this._cardElement=e.content.firstElementChild.cloneNode(!0)}_setEventListeners(){this._cardLikeButton.addEventListener("click",(()=>{this._handleLikeButtonClick(this)})),this._cardDeleteButton.addEventListener("click",(()=>{this._handleDeleteButtonClick(this)})),this.cardImageElement.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}handleDeleteButton=()=>{this._cardElement.remove(),this._cardElement=null};setIsLiked(e){this._isLiked=e,this.renderLikes()}isLiked(){return this._isLiked}renderLikes(){this._isLiked?this._cardLikeButton.classList.add("liked"):this._cardLikeButton.classList.remove("liked")}getView(){return this._getTemplate(),this._cardLikeButton=this._cardElement.querySelector(".card__like-button"),this._cardDeleteButton=this._cardElement.querySelector(".card__delete-button"),this.cardTitleElement=this._cardElement.querySelector(".card__title"),this.cardImageElement=this._cardElement.querySelector(".card__image"),this.cardTitleElement.textContent=this._name,this.cardImageElement.src=this._link,this.cardImageElement.alt=this._name,this._setEventListeners(),this.renderLikes(),this._cardElement}}class s{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{const t=this._renderer(e);this._container.append(t)}))}addItem(e){this._container.prepend(e)}}class r{constructor(e){this._popup=document.querySelector(e),this._closeButton=this._popup.querySelector(".modal__close")}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._closeButton.addEventListener("click",(()=>{this.close()})),this._popup.addEventListener("click",(e=>{e.target===this._popup&&this.close()}))}_handleEscClose=e=>{"Escape"===e.key&&this.close()}}class i extends r{constructor(e,t){super(e),this._submitCallback=t,this._form=this._popup.querySelector(".modal__form"),this._inputFields=Array.from(this._form.querySelectorAll(".modal__text-input")),this._submitButton=this._form.querySelector(".modal__button")}_getInputValues(){const e={};return this._inputFields.forEach((t=>{e[t.name]=t.value})),e}close(){this._form.reset(),super.close()}renderLoading(e){this._submitButton.textContent=e?"Saving...":"Save"}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._submitCallback(this._getInputValues())}))}}const n={formSelector:".modal__form",inputSelector:".modal__text-input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button-inactive",inputErrorClass:"modal__invalid",errorClass:"modal__invalid_active",inputInvalidClass:"modal__text_invalid"},o=document.querySelector(".profile__edit-button"),a=document.querySelector(".profile__add-button"),l=document.querySelector("#title-textbox"),d=document.querySelector("#subtitle-textbox"),c=document.querySelector("#card-title-textbox"),h=document.querySelector("#card-subtitle-textbox"),u=document.querySelector(".profile__add-image"),_=new class{constructor(e){this.baseUrl=e.baseUrl,this.headers=e.headers}_checkServerResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this.baseUrl}/cards`,{headers:this.headers}).then(this._checkServerResponse)}getUserInfo(){return fetch(`${this.baseUrl}/users/me`,{headers:this.headers}).then(this._checkServerResponse)}updateProfile(e,t){return fetch(`${this.baseUrl}/users/me`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then(this._checkServerResponse)}addCard(e){let{name:t,link:s}=e;return fetch(`${this.baseUrl}/cards`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:s})}).then(this._checkServerResponse)}deleteCard(e){return fetch(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.headers}).then(this._checkServerResponse)}dislikeCard(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this.headers}).then(this._checkServerResponse)}likeCard(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this.headers}).then(this._checkServerResponse)}updateAvatar(e){let{link:t}=e;return fetch(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:t})}).then(this._checkServerResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"d9d73c7f-57bf-4e5e-8837-ef7b15edaabc","Content-Type":"application/json"}});function m(e){e.isLiked()?_.dislikeCard(e._id).then((t=>{e.setIsLiked(t.isLiked)})).catch((e=>{console.error(e)})):_.likeCard(e._id).then((t=>{e.setIsLiked(t.isLiked)})).catch(console.error)}function p(e){v.setConfirm((()=>{v.renderLoading(!0),_.deleteCard(e._id).then((t=>{e.handleDeleteButton(t),v.close()})).catch((e=>{console.error("Error deleting card:",e)})).finally((()=>{v.renderLoading(!1)}))})),v.open()}const v=new class extends r{constructor(e){super(e),this._popupForm=this._popup.querySelector(".modal__form"),this._submitButton=this._popupForm.querySelector(".modal__button")}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()})),super.setEventListeners()}setConfirm(e){this._handleFormSubmit=e}renderLoading(e){this._submitButton.textContent=e?"Deleting...":"delete"}}("#delete-modal-popup",p);v.setEventListeners(),u.addEventListener("click",f);const E=new i("#modal-avatar-popup",(function(e){E.renderLoading(!0),_.updateAvatar(e).then((e=>{console.log("Avatar updated successfully"),k.setAvatar(e.avatar),E.close()})).catch((e=>{console.error("Error updating avatar:",e)})).finally((()=>{E.renderLoading(!1)}))}));function f(){E.open()}E.setEventListeners();const b=new i("#profile-add-modal",(function(){b.renderLoading(!0),console.log(),_.addCard({name:c.value,link:h.value}).then((e=>{console.log("Card added successfully:"),function(e){const t=I(e);x.addItem(t)}(e),b.close()})).catch((e=>{console.error("Error adding card:",e)})).finally((()=>{b.renderLoading(!1)}))})),L=new i("#profile-edit-modal",(function(){const e=l.value,t=d.value;L.renderLoading(!0),_.updateProfile(e,t).then((()=>{console.log("Profile updated successfully:"),k.setUserInfo({name:e,job:t}),L.close()})).catch((e=>{console.error("Error updating profile:",e)})).finally((()=>{L.renderLoading(!1)}))}));b.setEventListeners(),L.setEventListeners(),a.addEventListener("click",(()=>{b.open()})),o.addEventListener("click",(()=>{const{name:e,job:t}=k.getUserInfo();l.value=e,d.value=t,L.open()}));const k=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:r}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(s),this._avatarElement=document.querySelector(r)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._nameElement.textContent=t,this._jobElement.textContent=s}setAvatar(e){this._avatarElement.src=e}}({nameSelector:".profile__title",jobSelector:".profile__subtitle",avatarSelector:".profile__image"}),S=document.forms["add-form"],C=document.forms["modal-form"],g=new e(n,S),y=new e(n,C);function B(e){q.open(e)}function I(e){return new t(e,"#card-template",B,p,m,f).getView()}g.disableButton(),y.disableButton(),g.enableValidation(),y.enableValidation();const q=new class extends r{constructor(e){super(e),this._image=this._popup.querySelector(".modal__image"),this._caption=this._popup.querySelector(".modal__image-subtitle")}open(e){this._image.src=e.link,this._image.alt=`Photo of ${e.name}`,this._caption.textContent=e.name,super.open()}setEventListeners(){super.setEventListeners()}}("#modal-image-preview");let x;q.setEventListeners(),Promise.all([_.getInitialCards(),_.getUserInfo()]).then((e=>{let[t,r]=e;x=new s({items:t,renderer:I},".cards__list"),x.renderItems(),k.setUserInfo({name:r.name,about:r.about}),k.setAvatar(r.avatar)})).catch((e=>{console.error("Error fetching initial data:",e)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUFDUixDQUVBSSxpQkFBQUEsR0FDRU0sTUFBTU4sbUJBQ1IsR0orTW9DLHdCQUd0QyxJQUFJMEUsRUFGSmtCLEVBQVc1RixvQkFJWGdDLFFBQVErRCxJQUFJLENBQUN2RSxFQUFJVyxrQkFBbUJYLEVBQUljLGdCQUNyQ0QsTUFBSzNELElBQTJCLElBQXpCc0gsRUFBT0MsR0FBYXZILEVBQzFCZ0csRUFBYyxJQUFJakcsRUFDaEIsQ0FDRUcsTUFBT29ILEVBQ1BuSCxTQUFVNEYsR0FFWixnQkFFRkMsRUFBWXpGLGNBRVpvRixFQUFTVSxZQUFZLENBQ25CakksS0FBTW1KLEVBQWFuSixLQUNuQjBGLE1BQU95RCxFQUFhekQsUUFFdEI2QixFQUFTQyxVQUFVMkIsRUFBYTdDLE9BQU8sSUFFeENHLE9BQU9HLElBQ05ELFFBQVFDLE1BQU0sK0JBQWdDQSxFQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9VdGlscy9Db25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cERlbGV0ZUNvbmZpcm0uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IHNldHRpbmdzLmZvcm1TZWxlY3RvcjtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEludmFsaWRDbGFzcyA9IHNldHRpbmdzLmlucHV0SW52YWxpZENsYXNzO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuXHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuICAgIHRoaXMuX2lucHV0cyA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUFsbEVycm9ycygpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudHMgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGAuJHt0aGlzLl9pbnB1dEVycm9yQ2xhc3N9YClcclxuICAgICk7XHJcbiAgICBlcnJvckVsZW1lbnRzLmZvckVhY2goKGVycm9yRWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihlcnJvckVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfdmFsaWRhdGVJbnB1dChpbnB1dCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gaW5wdXQucGFyZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7dGhpcy5faW5wdXRFcnJvckNsYXNzfWBcclxuICAgICk7XHJcbiAgICBpZiAoIWlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGVycm9yRWxlbWVudCwgaW5wdXQudmFsaWRhdGlvbk1lc3NhZ2UsIGlucHV0KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGVycm9yRWxlbWVudCwgaW5wdXQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGVycm9yRWxlbWVudCwgbWVzc2FnZSwgaW5wdXQpIHtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIGlmIChpbnB1dCkge1xyXG4gICAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0SW52YWxpZENsYXNzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihlcnJvckVsZW1lbnQsIGlucHV0KSB7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICBpZiAoaW5wdXQpIHtcclxuICAgICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEludmFsaWRDbGFzcyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBjb25zdCBpc1ZhbGlkID0gdGhpcy5faW5wdXRzLmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsaWRpdHkudmFsaWQpO1xyXG4gICAgaWYgKGlzVmFsaWQpIHtcclxuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCB0cnVlKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3ZhbGlkYXRlSW5wdXQoaW5wdXQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgaWYgKHRoaXMuX3N1Ym1pdEJ1dHRvbikge1xyXG4gICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVCdXR0b25DbGljayxcclxuICAgIGhhbmRsZUxpa2VCdXR0b25DbGlja1xyXG4gICkge1xyXG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGRhdGEuaXNMaWtlZDtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2sgPSBoYW5kbGVEZWxldGVCdXR0b25DbGljaztcclxuICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b25DbGljayA9IGhhbmRsZUxpa2VCdXR0b25DbGljaztcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IHRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0ZW1wbGF0ZS5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkLmNsb25lTm9kZSh0cnVlKTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b25DbGljayh0aGlzKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmREZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2sodGhpcyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLmNhcmRJbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7XHJcbiAgICAgICAgbmFtZTogdGhpcy5fbmFtZSxcclxuICAgICAgICBsaW5rOiB0aGlzLl9saW5rLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlRGVsZXRlQnV0dG9uID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgfTtcclxuXHJcbiAgc2V0SXNMaWtlZChpc0xpa2VkKSB7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcclxuICAgIHRoaXMucmVuZGVyTGlrZXMoKTtcclxuICB9XHJcblxyXG4gIGlzTGlrZWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faXNMaWtlZDtcclxuICB9XHJcblxyXG4gIHJlbmRlckxpa2VzKCkge1xyXG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImxpa2VkXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImxpa2VkXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0VmlldygpIHtcclxuICAgIHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcblxyXG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b24gPVxyXG4gICAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fY2FyZERlbGV0ZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIlxyXG4gICAgKTtcclxuICAgIHRoaXMuY2FyZFRpdGxlRWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgICB0aGlzLmNhcmRJbWFnZUVsZW1lbnQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG5cclxuICAgIHRoaXMuY2FyZFRpdGxlRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLmNhcmRJbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuY2FyZEltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLnJlbmRlckxpa2VzKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGNhcmRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xyXG4gICAgICBpZiAoZXZlbnQudGFyZ2V0ID09PSB0aGlzLl9wb3B1cCkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZlbnQpID0+IHtcclxuICAgIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIHN1Ym1pdENhbGxiYWNrKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3N1Ym1pdENhbGxiYWNrID0gc3VibWl0Q2FsbGJhY2s7XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2lucHV0RmllbGRzID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX190ZXh0LWlucHV0XCIpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCB2YWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0RmllbGRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIHZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZyhsb2FkaW5nKSB7XHJcbiAgICBpZiAobG9hZGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5fc3VibWl0Q2FsbGJhY2sodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIkZlcnJpcyBXaGVlbFwiLFxyXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTcwMDQzMzE1ODk2OC1iMWFiZjI1YmI4Zjk/cT04MCZ3PTE4ODcmYXV0bz1mb3JtYXQmZml0PWNyb3AmaXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkFpciBCYWxsb25cIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE1NTk5MjYyMjMtZTcwMDM2YTE4Y2ViP3E9ODAmdz0xODg3JmF1dG89Zm9ybWF0JmZpdD1jcm9wJml4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRFwiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJGYWxscyBDcmVla1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTU1MTY3NTcwNS03MjUxM2MyNzIyYTI/cT04MCZ3PTE5NzYmYXV0bz1mb3JtYXQmZml0PWNyb3AmaXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIk9sZCBNaWxsXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNjE4NTc3MjAxNTg1LTNhZmEyZWM4ODJiMT9xPTgwJnc9MTk0NCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZpeGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0RcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQ2F5b25cIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE0OTE0NjY0MjQ5MzYtZTMwNDkxOWFhZGE3P3E9ODAmdz0yMDY5JmF1dG89Zm9ybWF0JmZpdD1jcm9wJml4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRFwiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJGdXNpbmUgTGFrZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3BsdXMudW5zcGxhc2guY29tL3ByZW1pdW1fcGhvdG8tMTY2OTIzOTExMzU5OS1mNTFiNzY1ODdkYzk/cT04MCZ3PTE5MzMmYXV0bz1mb3JtYXQmZml0PWNyb3AmaXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX190ZXh0LWlucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b24taW5hY3RpdmVcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2ludmFsaWRcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19pbnZhbGlkX2FjdGl2ZVwiLFxyXG4gIGlucHV0SW52YWxpZENsYXNzOiBcIm1vZGFsX190ZXh0X2ludmFsaWRcIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuZXhwb3J0IGNvbnN0IGVkaXRNb2RhbFRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3RpdGxlLXRleHRib3hcIik7XHJcbmV4cG9ydCBjb25zdCBlZGl0TW9kYWxTdWJ0aXRsZUlucHV0ID1cclxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3N1YnRpdGxlLXRleHRib3hcIik7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10aXRsZS10ZXh0Ym94XCIpO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZFVybElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXN1YnRpdGxlLXRleHRib3hcIik7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtaW1hZ2VcIik7XHJcbiIsIi8vIEltcG9ydGVkIG1vZHVsZXMgYW5kIGNvbXBvbmVudHNcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBEZWxldGVDb25maXJtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwRGVsZXRlQ29uZmlybS5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGluaXRpYWxDYXJkcyxcclxuICBjb25maWcsXHJcbiAgcHJvZmlsZUVkaXRCdXR0b24sXHJcbiAgcHJvZmlsZUFkZEJ1dHRvbixcclxuICBlZGl0TW9kYWxUaXRsZUlucHV0LFxyXG4gIGVkaXRNb2RhbFN1YnRpdGxlSW5wdXQsXHJcbiAgYWRkQ2FyZFRpdGxlSW5wdXQsXHJcbiAgYWRkQ2FyZFVybElucHV0LFxyXG4gIGF2YXRhckljb24sXHJcbn0gZnJvbSBcIi4uL1V0aWxzL0NvbnN0YW50cy5qc1wiO1xyXG5cclxuLy8gSW5zdGFudGlhdGUgQVBJXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImQ5ZDczYzdmLTU3YmYtNGU1ZS04ODM3LWVmN2IxNWVkYWFiY1wiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG4vLyBGdW5jdGlvbiB0byBoYW5kbGUgbGlrZSBidXR0b24gY2xpY2tcclxuZnVuY3Rpb24gaGFuZGxlTGlrZUJ1dHRvbkNsaWNrKGNhcmQpIHtcclxuICBpZiAoY2FyZC5pc0xpa2VkKCkpIHtcclxuICAgIGFwaVxyXG4gICAgICAuZGlzbGlrZUNhcmQoY2FyZC5faWQpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBjYXJkLnNldElzTGlrZWQocmVzLmlzTGlrZWQpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgfSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGFwaVxyXG4gICAgICAubGlrZUNhcmQoY2FyZC5faWQpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBjYXJkLnNldElzTGlrZWQocmVzLmlzTGlrZWQpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBGdW5jdGlvbiB0byBoYW5kbGUgZGVsZXRlIGJ1dHRvbiBjbGlja1xyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVCdXR0b25DbGljayhjYXJkKSB7XHJcbiAgZGVsZXRlTW9kYWxQb3B1cC5zZXRDb25maXJtKCgpID0+IHtcclxuICAgIGRlbGV0ZU1vZGFsUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICAgIGFwaVxyXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLl9pZClcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGNhcmQuaGFuZGxlRGVsZXRlQnV0dG9uKHJlcyk7XHJcbiAgICAgICAgZGVsZXRlTW9kYWxQb3B1cC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGRlbGV0aW5nIGNhcmQ6XCIsIGVycm9yKTtcclxuICAgICAgfSlcclxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgIGRlbGV0ZU1vZGFsUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICAgIH0pO1xyXG4gIH0pO1xyXG4gIGRlbGV0ZU1vZGFsUG9wdXAub3BlbigpO1xyXG59XHJcblxyXG4vLyBDcmVhdGluZyBhbiBpbnN0YW5jZSBvZiBQb3B1cFdpdGhGb3JtIGZvciBkZWxldGUgbW9kYWxcclxuY29uc3QgZGVsZXRlTW9kYWxQb3B1cCA9IG5ldyBQb3B1cERlbGV0ZUNvbmZpcm0oXHJcbiAgXCIjZGVsZXRlLW1vZGFsLXBvcHVwXCIsXHJcbiAgaGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2tcclxuKTtcclxuXHJcbmRlbGV0ZU1vZGFsUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGhhbmRsZSBhdmF0YXIgZm9ybSBzdWJtaXNzaW9uXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhckZvcm1TdWJtaXQoZGF0YSkge1xyXG4gIGF2YXRhck1vZGFsUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuXHJcbiAgYXBpXHJcbiAgICAudXBkYXRlQXZhdGFyKGRhdGEpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiQXZhdGFyIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5XCIpO1xyXG4gICAgICB1c2VySW5mby5zZXRBdmF0YXIocmVzLmF2YXRhcik7XHJcbiAgICAgIGF2YXRhck1vZGFsUG9wdXAuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB1cGRhdGluZyBhdmF0YXI6XCIsIGVycm9yKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGF2YXRhck1vZGFsUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLy8gRXZlbnQgbGlzdGVuZXIgZm9yIGF2YXRhciBpY29uIGNsaWNrIHRvIG9wZW4gYXZhdGFyIG1vZGFsXHJcbmF2YXRhckljb24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUF2YXRhckNsaWNrKTtcclxuXHJcbmNvbnN0IGF2YXRhck1vZGFsUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNtb2RhbC1hdmF0YXItcG9wdXBcIixcclxuICBoYW5kbGVBdmF0YXJGb3JtU3VibWl0XHJcbik7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJDbGljaygpIHtcclxuICBhdmF0YXJNb2RhbFBvcHVwLm9wZW4oKTtcclxufVxyXG5cclxuYXZhdGFyTW9kYWxQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gRnVuY3Rpb24gdG8gaGFuZGxlIGNhcmQgZm9ybSBzdWJtaXNzaW9uXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRGb3JtU3VibWl0KCkge1xyXG4gIGFkZENhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gIGNvbnNvbGUubG9nKCk7XHJcbiAgYXBpXHJcbiAgICAuYWRkQ2FyZCh7XHJcbiAgICAgIG5hbWU6IGFkZENhcmRUaXRsZUlucHV0LnZhbHVlLFxyXG4gICAgICBsaW5rOiBhZGRDYXJkVXJsSW5wdXQudmFsdWUsXHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKGNhcmREYXRhKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiQ2FyZCBhZGRlZCBzdWNjZXNzZnVsbHk6XCIpO1xyXG4gICAgICByZW5kZXJDYXJkKGNhcmREYXRhKTtcclxuICAgICAgYWRkQ2FyZFBvcHVwLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgYWRkaW5nIGNhcmQ6XCIsIGVycm9yKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGFkZENhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyBDcmVhdGluZyBpbnN0YW5jZXMgb2YgcG9wdXAgZm9ybXNcclxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIjcHJvZmlsZS1hZGQtbW9kYWxcIixcclxuICBoYW5kbGVDYXJkRm9ybVN1Ym1pdFxyXG4pO1xyXG5jb25zdCBlZGl0TW9kYWxQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxyXG4gIGVkaXRQcm9maWxlTW9kYWxcclxuKTtcclxuXHJcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5lZGl0TW9kYWxQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gRXZlbnQgbGlzdGVuZXJzIGZvciBidXR0b25zXHJcbnByb2ZpbGVBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRDYXJkUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3QgeyBuYW1lLCBqb2IgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgZWRpdE1vZGFsVGl0bGVJbnB1dC52YWx1ZSA9IG5hbWU7XHJcbiAgZWRpdE1vZGFsU3VidGl0bGVJbnB1dC52YWx1ZSA9IGpvYjtcclxuICBlZGl0TW9kYWxQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuLy8gQ3JlYXRpbmcgVXNlckluZm8gaW5zdGFuY2VcclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fdGl0bGVcIixcclxuICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fc3VidGl0bGVcIixcclxuICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9faW1hZ2VcIixcclxufSk7XHJcblxyXG4vLyBGdW5jdGlvbiB0byBoYW5kbGUgZWRpdCBwcm9maWxlIGZvcm0gc3VibWlzc2lvblxyXG5mdW5jdGlvbiBlZGl0UHJvZmlsZU1vZGFsKCkge1xyXG4gIGNvbnN0IG5ld05hbWUgPSBlZGl0TW9kYWxUaXRsZUlucHV0LnZhbHVlO1xyXG4gIGNvbnN0IG5ld0pvYiA9IGVkaXRNb2RhbFN1YnRpdGxlSW5wdXQudmFsdWU7XHJcblxyXG4gIGVkaXRNb2RhbFBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcblxyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZVByb2ZpbGUobmV3TmFtZSwgbmV3Sm9iKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIlByb2ZpbGUgdXBkYXRlZCBzdWNjZXNzZnVsbHk6XCIpO1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7IG5hbWU6IG5ld05hbWUsIGpvYjogbmV3Sm9iIH0pO1xyXG4gICAgICBlZGl0TW9kYWxQb3B1cC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHVwZGF0aW5nIHByb2ZpbGU6XCIsIGVycm9yKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGVkaXRNb2RhbFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIFNlbGVjdGluZyBwcm9maWxlIGZvcm0gZWxlbWVudHNcclxuY29uc3QgcHJvZmlsZUFkZGVkRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiYWRkLWZvcm1cIl07XHJcbmNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJtb2RhbC1mb3JtXCJdO1xyXG5cclxuLy8gQ3JlYXRpbmcgZm9ybSB2YWxpZGF0b3JzXHJcbmNvbnN0IGNhcmRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBwcm9maWxlQWRkZWRGb3JtKTtcclxuY29uc3QgcHJvZmlsZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHByb2ZpbGVGb3JtKTtcclxuXHJcbi8vIERpc2FibGluZyBmb3JtIGJ1dHRvbnNcclxuY2FyZEZvcm1WYWxpZGF0b3IuZGlzYWJsZUJ1dHRvbigpO1xyXG5wcm9maWxlRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XHJcblxyXG4vLyBFbmFibGluZyBmb3JtIHZhbGlkYXRpb25cclxuY2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5wcm9maWxlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4vLyBGdW5jdGlvbiB0byBoYW5kbGUgaW1hZ2UgY2xpY2tcclxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhjYXJkRGF0YSkge1xyXG4gIGltYWdlUG9wdXAub3BlbihjYXJkRGF0YSk7XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGNyZWF0ZSBjYXJkIEhUTUxcclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChpdGVtKSB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXcgQ2FyZChcclxuICAgIGl0ZW0sXHJcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXHJcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgaGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlQnV0dG9uQ2xpY2ssXHJcbiAgICBoYW5kbGVBdmF0YXJDbGlja1xyXG4gICk7XHJcblxyXG4gIHJldHVybiBjYXJkRWxlbWVudC5nZXRWaWV3KCk7XHJcbn1cclxuXHJcbi8vIENyZWF0aW5nIGluc3RhbmNlIG9mIFBvcHVwV2l0aEltYWdlXHJcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjbW9kYWwtaW1hZ2UtcHJldmlld1wiKTtcclxuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxubGV0IGNhcmRTZWN0aW9uO1xyXG5cclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRJbml0aWFsQ2FyZHMoKSwgYXBpLmdldFVzZXJJbmZvKCldKVxyXG4gIC50aGVuKChbY2FyZHMsIHVzZXJJbmZvRGF0YV0pID0+IHtcclxuICAgIGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAgICAgIHtcclxuICAgICAgICBpdGVtczogY2FyZHMsXHJcbiAgICAgICAgcmVuZGVyZXI6IGNyZWF0ZUNhcmQsXHJcbiAgICAgIH0sXHJcbiAgICAgIFwiLmNhcmRzX19saXN0XCJcclxuICAgICk7XHJcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG5cclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgICAgbmFtZTogdXNlckluZm9EYXRhLm5hbWUsXHJcbiAgICAgIGFib3V0OiB1c2VySW5mb0RhdGEuYWJvdXQsXHJcbiAgICB9KTtcclxuICAgIHVzZXJJbmZvLnNldEF2YXRhcih1c2VySW5mb0RhdGEuYXZhdGFyKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBpbml0aWFsIGRhdGE6XCIsIGVycm9yKTtcclxuICB9KTtcclxuXHJcbmZ1bmN0aW9uIHJlbmRlckNhcmQoY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xyXG4gIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xyXG4gICAgdGhpcy5iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xyXG4gICAgdGhpcy5oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrU2VydmVyUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlUHJvZmlsZShuYW1lLCBhYm91dCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgLi4udGhpcy5oZWFkZXJzLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICBhYm91dDogYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1NlcnZlclJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgLi4udGhpcy5oZWFkZXJzLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICBsaW5rOiBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGlkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZGlzbGlrZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBsaWtlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1NlcnZlclJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUF2YXRhcih7IGxpbmsgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhcjogbGluayB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBDb25maXJtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCgpO1xyXG4gICAgfSk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgc2V0Q29uZmlybShoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcobG9hZGluZykge1xyXG4gICAgaWYgKGxvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJEZWxldGluZy4uLlwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJkZWxldGVcIjtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICBqb2I6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gIH1cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQgPSBhYm91dDtcclxuICB9XHJcblxyXG4gIHNldEF2YXRhcihhdmF0YXIpIHtcclxuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcHRpb24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZS1zdWJ0aXRsZVwiKTtcclxuICB9XHJcblxyXG4gIG9wZW4oZGF0YSkge1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gYFBob3RvIG9mICR7ZGF0YS5uYW1lfWA7XHJcbiAgICB0aGlzLl9jYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiRm9ybVZhbGlkYXRvciIsImNvbnN0cnVjdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsInRoaXMiLCJfZm9ybVNlbGVjdG9yIiwiZm9ybVNlbGVjdG9yIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2lucHV0SW52YWxpZENsYXNzIiwiaW5wdXRJbnZhbGlkQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJfc3VibWl0QnV0dG9uIiwicXVlcnlTZWxlY3RvciIsIl9pbnB1dHMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2hpZGVBbGxFcnJvcnMiLCJmb3JFYWNoIiwiZXJyb3JFbGVtZW50IiwiX2hpZGVJbnB1dEVycm9yIiwiX3ZhbGlkYXRlSW5wdXQiLCJpbnB1dCIsInBhcmVudEVsZW1lbnQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJtZXNzYWdlIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJldmVyeSIsIl9lbmFibGVCdXR0b24iLCJfZGlzYWJsZUJ1dHRvbiIsInJlbW92ZUF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJhZGRFdmVudExpc3RlbmVyIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJkaXNhYmxlQnV0dG9uIiwiQ2FyZCIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2siLCJoYW5kbGVMaWtlQnV0dG9uQ2xpY2siLCJfaWQiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2siLCJfaGFuZGxlTGlrZUJ1dHRvbkNsaWNrIiwiX2dldFRlbXBsYXRlIiwidGVtcGxhdGUiLCJkb2N1bWVudCIsIl9jYXJkRWxlbWVudCIsImNvbnRlbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImNsb25lTm9kZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9jYXJkTGlrZUJ1dHRvbiIsIl9jYXJkRGVsZXRlQnV0dG9uIiwiY2FyZEltYWdlRWxlbWVudCIsImhhbmRsZURlbGV0ZUJ1dHRvbiIsInNldElzTGlrZWQiLCJyZW5kZXJMaWtlcyIsImdldFZpZXciLCJjYXJkVGl0bGVFbGVtZW50Iiwic3JjIiwiYWx0IiwiU2VjdGlvbiIsIl9yZWYiLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiY2FyZEVsZW1lbnQiLCJhcHBlbmQiLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfY2xvc2VCdXR0b24iLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJldmVudCIsInRhcmdldCIsImtleSIsIlBvcHVwV2l0aEZvcm0iLCJzdWJtaXRDYWxsYmFjayIsInN1cGVyIiwiX3N1Ym1pdENhbGxiYWNrIiwiX2Zvcm0iLCJfaW5wdXRGaWVsZHMiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJ2YWx1ZXMiLCJ2YWx1ZSIsInJlc2V0IiwicmVuZGVyTG9hZGluZyIsImxvYWRpbmciLCJjb25maWciLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVBZGRCdXR0b24iLCJlZGl0TW9kYWxUaXRsZUlucHV0IiwiZWRpdE1vZGFsU3VidGl0bGVJbnB1dCIsImFkZENhcmRUaXRsZUlucHV0IiwiYWRkQ2FyZFVybElucHV0IiwiYXZhdGFySWNvbiIsImFwaSIsIm9wdGlvbnMiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9jaGVja1NlcnZlclJlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwidGhlbiIsImdldFVzZXJJbmZvIiwidXBkYXRlUHJvZmlsZSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhZGRDYXJkIiwiZGVsZXRlQ2FyZCIsImlkIiwiZGlzbGlrZUNhcmQiLCJsaWtlQ2FyZCIsInVwZGF0ZUF2YXRhciIsIl9yZWYyIiwiYXZhdGFyIiwiYXV0aG9yaXphdGlvbiIsImNhcmQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImRlbGV0ZU1vZGFsUG9wdXAiLCJzZXRDb25maXJtIiwiZmluYWxseSIsIl9wb3B1cEZvcm0iLCJlIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJoYW5kbGVGb3JtU3VibWl0IiwiaGFuZGxlQXZhdGFyQ2xpY2siLCJhdmF0YXJNb2RhbFBvcHVwIiwibG9nIiwidXNlckluZm8iLCJzZXRBdmF0YXIiLCJhZGRDYXJkUG9wdXAiLCJjYXJkRGF0YSIsImNyZWF0ZUNhcmQiLCJjYXJkU2VjdGlvbiIsInJlbmRlckNhcmQiLCJlZGl0TW9kYWxQb3B1cCIsIm5ld05hbWUiLCJuZXdKb2IiLCJzZXRVc2VySW5mbyIsImpvYiIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZUVsZW1lbnQiLCJfam9iRWxlbWVudCIsIl9hdmF0YXJFbGVtZW50IiwicHJvZmlsZUFkZGVkRm9ybSIsImZvcm1zIiwicHJvZmlsZUZvcm0iLCJjYXJkRm9ybVZhbGlkYXRvciIsInByb2ZpbGVGb3JtVmFsaWRhdG9yIiwiaW1hZ2VQb3B1cCIsIl9pbWFnZSIsIl9jYXB0aW9uIiwiYWxsIiwiY2FyZHMiLCJ1c2VySW5mb0RhdGEiXSwic291cmNlUm9vdCI6IiJ9